<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>快速排序可视化</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .container {
            display: flex;
            width: 100%;
            max-width: 1200px;
        }
        .code, .visualization {
            flex: 1;
            margin: 10px;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        #array {
            display: flex;
            height: 200px;
            align-items: flex-end;
            border-bottom: 1px solid #333;
        }
        .bar {
            width: 20px;
            background-color: #3498db;
            margin: 0 1px;
            transition: height 0.3s;
        }
        .controls {
            margin-top: 20px;
        }
        .summary {
            margin-top: 20px;
            text-align: left;
            width: 100%;
            max-width: 1200px;
        }
    </style>
</head>
<body>
    <h1>快速排序可视化</h1>
    <div class="container">
        <div class="code">
            <h2>核心代码</h2>
            <pre><code>
function quickSort(arr, low, high) {
    if (low < high) {
        let pivotIndex = partition(arr, low, high);
        quickSort(arr, low, pivotIndex - 1);
        quickSort(arr, pivotIndex + 1, high);
    }
}

function partition(arr, low, high) {
    let pivot = arr[high];
    let i = low - 1;
    
    for (let j = low; j < high; j++) {
        if (arr[j] < pivot) {
            i++;
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
    }
    
    [arr[i + 1], arr[high]] = [arr[high], arr[i + 1]];
    return i + 1;
}
            </code></pre>
        </div>
        <div class="visualization">
            <h2>可视化动画</h2>
            <div id="array"></div>
            <div class="controls">
                <label for="arraySize">数组大小：</label>
                <input type="number" id="arraySize" min="5" max="50" value="20">
                <label for="animationSpeed">动画速度：</label>
                <input type="range" id="animationSpeed" min="1" max="1000" value="500">
                <button onclick="initArray()">生成新数组</button>
                <button onclick="startSort()">开始排序</button>
            </div>
        </div>
    </div>
    <div class="summary">
        <h2>快速排序算法特点总结</h2>
        <ul>
            <li>平均时间复杂度：O(n log n)</li>
            <li>最坏时间复杂度：O(n²)，当数组已经排序或接近排序时</li>
            <li>空间复杂度：O(log n)，因为使用递归</li>
            <li>原地排序算法，不需要额外的数组空间</li>
            <li>不稳定排序，相同元素的相对位置可能改变</li>
            <li>分治策略：选择一个基准元素，将数组分为两部分，递归排序</li>
            <li>对于大型数据集表现良好，是实践中最快的排序算法之一</li>
            <li>随机选择基准元素可以提高算法在已排序数组上的性能</li>
            <li>适合并行化，可以在多核处理器上高效实现</li>
        </ul>
    </div>

    <script>
        let array = [];
        let arraySize = 20;
        let animationSpeed = 500;

        function initArray() {
            arraySize = parseInt(document.getElementById('arraySize').value);
            array = Array.from({length: arraySize}, () => Math.floor(Math.random() * 100) + 1);
            updateVisualization();
        }

        function updateVisualization() {
            const arrayContainer = document.getElementById('array');
            arrayContainer.innerHTML = '';
            const maxVal = Math.max(...array);
            array.forEach(val => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${(val / maxVal) * 100}%`;
                arrayContainer.appendChild(bar);
            });
        }

        async function quickSort(low, high) {
            if (low < high) {
                let pivotIndex = await partition(low, high);
                await quickSort(low, pivotIndex - 1);
                await quickSort(pivotIndex + 1, high);
            }
        }

        async function partition(low, high) {
            let pivot = array[high];
            let i = low - 1;
            
            for (let j = low; j < high; j++) {
                if (array[j] < pivot) {
                    i++;
                    await swap(i, j);
                }
            }
            
            await swap(i + 1, high);
            return i + 1;
        }

        async function swap(i, j) {
            [array[i], array[j]] = [array[j], array[i]];
            updateVisualization();
            await new Promise(resolve => setTimeout(resolve, animationSpeed));
        }

        function startSort() {
            animationSpeed = 1000 - document.getElementById('animationSpeed').value;
            quickSort(0, array.length - 1);
        }

        initArray();
    </script>
</body>
</html>